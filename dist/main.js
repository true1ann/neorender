window.nr=class{static components={};static mountedComponents={};static version="NeoRender Sr2";static verNum=2;static lastError=null;static lastWarn=null;static errorEvent(t){const e=t instanceof Error?t.message:t,n=t instanceof Error?t.stack:null;this.lastError=e;const o={message:this.lastError,stack:n},r=new CustomEvent("neoRenderError",{detail:o});window.dispatchEvent(r)}static warnEvent(t){this.lastWarn=t;const e=new CustomEvent("neoRenderWarn",{detail:this.lastWarn});window.dispatchEvent(e)}static defineComponent(t){try{return t.name&&t.template?(this.components[t.name]=t,!0):(this.errorEvent(new Error("Components must have a Name and a Template.")),!1)}catch(t){return this.errorEvent(t),!1}}static returnComponent(t,e,n){try{const o=this.components[t];if(!o)return this.errorEvent(new Error(`Component ${t} is not defined.`)),!1;let r,s={useShadowRoot:!0,closeShadowRoot:!1,mountConfig:{id:void 0,className:void 0}};if("function"==typeof o.beforeCreate){const t=o.beforeCreate(e,n);s={...s,...t}}const i=document.createElement("div");if(r=s.useShadowRoot?i.attachShadow({mode:s.closeShadowRoot?"closed":"open"}):i,s.mountConfig.id&&(i.id=s.mountConfig.id),s.mountConfig.className&&(i.className=s.mountConfig.className),r.innerHTML=o.template,o.scopedStyles&&s.useShadowRoot){const t=document.createElement("style");t.textContent=o.scopedStyles,r.appendChild(t)}return o.scopedStyles&&!s.useShadowRoot&&this.warnEvent(`Component "${o.name}" has scopedStyles, but shadowRoot is disabled. scopedStyles will be ignored.`),"function"==typeof o.main&&o.main(r,e),"function"==typeof o.afterCreate&&o.afterCreate(r,e),i}catch(t){return this.errorEvent(t),!1}}static async mount(t,e,n){try{if(!this.components[t])return this.errorEvent(new Error(`Component ${t} is not defined.`)),!1;const o=document.querySelector(e);return o?this.mountedComponents[e]?this.mountedComponents[e]===t?(this.warnEvent(`Component ${this.mountedComponents[e]} is already mounted to ${e}`),!0):(this.errorEvent(new Error(`Element ${e} already has a component mounted to it: ${this.mountedComponents[e]}`)),!1):(o.appendChild(await this.returnComponent(t,n,{type:"mount"})),this.mountedComponents[e]=t,!0):(this.errorEvent(new Error(`Element ${o} is not found.`)),!1)}catch(t){return this.errorEvent(t),!1}}static remount(t,e){try{return document.querySelector(t).innerHTML="",this.mount(e||this.mountedComponents[t],t)}catch(t){return this.errorEvent(t),!1}}static async unmount(t){try{const e=this.mountedComponents[t];if(e){const n=this.components[e];return"function"==typeof n.beforeDelete&&await n.beforeDelete.call(null),document.querySelector(t).innerHTML="",delete this.mountedComponents[t],!0}return this.warnEvent(`Tried to unmount NR from ${t}, but nothing was mounted to it.`),!0}catch(t){return this.errorEvent(t),!1}}static async scriptMount(t,e){try{const n=document.currentScript;if(!n)return this.errorEvent(new Error("scriptMount is NOT meant to be executed in script, or console. use mount/returnComponent instead.")),!1;const o=await this.returnComponent(t,e,{type:"scriptMount"});n.parentNode.replaceChild(o,n)}catch(t){this.errorEvent(t)}}};